[gd_scene load_steps=9 format=3 uid="uid://y03djfecm8p4"]

[ext_resource type="PackedScene" uid="uid://bi2rau283g2l6" path="res://dummy_agent.tscn" id="1_1hxmu"]
[ext_resource type="Texture2D" uid="uid://dltdiujt2av7s" path="res://Assets/kenney_shape-characters/PNG/Default/tile_grey.png" id="2_5qmts"]
[ext_resource type="BehaviorTree" uid="uid://bv6csbkmtc48m" path="res://ai/tree1.tres" id="3_2iei4"]
[ext_resource type="Texture2D" uid="uid://c8fnt88ij35hb" path="res://Assets/kenney_shape-characters/PNG/Default/yellow_body_square.png" id="3_piqc7"]

[sub_resource type="GDScript" id="GDScript_i6dm0"]
resource_name = "kitchen"
script/source = "extends Node2D

func _on_button_pressed() -> void:
	AgentManager.send_broadcast(&\"PISELLARE\", 69)
"

[sub_resource type="Curve2D" id="Curve2D_obaid"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 384, 192, 0, 0, 0, 0, 768, 192, 0, 0, 0, 0, 832, 320, 0, 0, 0, 0, 768, 448, 0, 0, 0, 0, 384, 448, 0, 0, 0, 0, 320, 320, 0, 0, 0, 0, 384, 192)
}
point_count = 7

[sub_resource type="GDScript" id="GDScript_rn7af"]
resource_name = "dummy"
script/source = "extends Agent

@export var mov_speed := 500.0
@export var path : Path2D

@onready var bt_player: BTPlayer = $BTPlayer

enum STATE {
	IDLE,
	FRIDGE,
	OVEN,
	TABLE,
	BREAK
}

var offset := 0.0
var state : int : 
	get:
		return bt_player.blackboard.get_var(\"state\", 0)
	set(s):
		if state == s:
			return
			
		bt_player.blackboard.set_var(\"state\", s)
		
			
var target_position := Vector2.ZERO

func _ready() -> void:
	super()
	
	state = STATE.IDLE
	
func _on_broadcast(id, val):
	if id == &\"PISELLARE\":
		state = STATE.FRIDGE
"

[sub_resource type="BlackboardPlan" id="BlackboardPlan_j72xp"]

[node name="Kitchen" type="Node2D"]
script = SubResource("GDScript_i6dm0")

[node name="IdlePath" type="Path2D" parent="."]
curve = SubResource("Curve2D_obaid")

[node name="DummyAgent" parent="." node_paths=PackedStringArray("path") instance=ExtResource("1_1hxmu")]
z_index = 10
position = Vector2(896, 424)
scale = Vector2(1, 1)
script = SubResource("GDScript_rn7af")
mov_speed = 200.0
path = NodePath("../IdlePath")

[node name="BTPlayer" type="BTPlayer" parent="DummyAgent"]
behavior_tree = ExtResource("3_2iei4")
blackboard_plan = SubResource("BlackboardPlan_j72xp")

[node name="Oven" type="Sprite2D" parent="." groups=["Ovens"]]
position = Vector2(64, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Oven2" type="Sprite2D" parent="." groups=["Ovens"]]
position = Vector2(192, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Oven3" type="Sprite2D" parent="." groups=["Ovens"]]
position = Vector2(960, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Oven4" type="Sprite2D" parent="." groups=["Ovens"]]
position = Vector2(1088, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Table" type="Sprite2D" parent="." groups=["Tables"]]
position = Vector2(512, 320)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Table2" type="Sprite2D" parent="." groups=["Tables"]]
position = Vector2(640, 320)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Table3" type="Sprite2D" parent="." groups=["Tables"]]
position = Vector2(512, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Table4" type="Sprite2D" parent="." groups=["Tables"]]
position = Vector2(640, 584)
scale = Vector2(1.6, 1.6)
texture = ExtResource("2_5qmts")

[node name="Fridge" type="Sprite2D" parent="." groups=["Fridges"]]
position = Vector2(1088, 128)
scale = Vector2(1.6, 3.2)
texture = ExtResource("2_5qmts")

[node name="DoughFridge" type="Sprite2D" parent="." groups=["Fridges"]]
position = Vector2(64, 128)
scale = Vector2(1.6, 3.2)
texture = ExtResource("2_5qmts")

[node name="Exit" type="Sprite2D" parent="." groups=["Exit"]]
position = Vector2(576, 16)
scale = Vector2(3.2, 0.4)
texture = ExtResource("3_piqc7")

[node name="Button" type="Button" parent="."]
offset_left = 8.0
offset_top = 296.0
offset_right = 153.0
offset_bottom = 343.0
pivot_offset = Vector2(0, 16)
theme_override_font_sizes/font_size = 28
text = "New pizza"

[connection signal="pressed" from="Button" to="." method="_on_button_pressed"]
